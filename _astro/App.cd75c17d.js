import{j as v,g as u,u as D,k as G,h as k,s as W,r as f,t as d,e as i,w as le,S as w,b as re,q as j,f as h,i as $,F as L,v as K,c as oe,d as U,n as E,A as se,M as z}from"./web.9ee1b91f.js";import{f as b,z as ie,A as M,a as ce,x as I,U as ae,c as ue,L as de}from"./index.4f2c4b12.js";/* empty css                       */import{C as $e,A as Q,T as R,a as ge,n as pe,c as me}from"./PromptGPT.509bee20.js";import{c as H}from"./index.79db8632.js";import{N}from"./notice.940364ec.js";import{Q as V}from"./index.b92d985b.js";import{T as fe,t as be}from"./newsReport.002ec313.js";import{b as xe,T as O,s as J,i as _e}from"./TagsConvertor.b3f5406f.js";import{u as X}from"./index.c584f020.js";import{G as P}from"./GlobalData.4e554cac.js";import"./index.7d109aa8.js";import{T as he}from"./TagAPI.b55cf1a1.js";import{G as ke}from"./GlobalHeader.98cdf1df.js";import{a as ve}from"./MessageHInt.3d0a2276.js";import{u as we}from"./Webview.b36c6241.js";import{M as Ce,b as A}from"./HeaderSecond.4fa7884b.js";import"./cloud.6055f26b.js";import"https://cdn.jsdelivr.net/npm/leancloud-storage@4.14.0/dist/av-min.js";import"./hasIn.294499a0.js";import"./memoize.49269b7f.js";import"./_commonjsHelpers.edff4021.js";import"./Panel.801c2a10.js";const ye=d('<div class="textarea-wrap"><textarea class="h-full w-full flex-1 bg-transparent outline-none"></textarea></div>',4),Te=e=>{const l=b(null);return ie(()=>{l()&&(l().dataset.replicatedValue=e.value())},[e.value,l]),(()=>{const n=u(ye),t=n.firstChild;return D(l,n),G(t,"keydown",e.onKeyDown,!0),G(t,"keyup",e.onKeyUp,!0),G(t,"blur",e.onBlur),t.$$input=o=>{const s=o.target.value;e.value(s)},k(o=>{const s=e.placeholder??"在这里可以输入文本",r=!e.disabled;return s!==o._v$&&W(t,"placeholder",o._v$=s),r!==o._v$2&&W(t,"contenteditable",o._v$2=r),o},{_v$:void 0,_v$2:void 0}),k(()=>t.value=e.value()),f(),n})()};v(["input","keyup","keydown"]);const Se=e=>i(Te,{get placeholder(){return e.placeholder},get value(){return e.text},onKeyDown:l=>{l.ctrlKey&&l.key==="Enter"&&e.onConfirmEnter&&e.onConfirmEnter()}}),B=le(),Fe=d('<label class="py-1 text-xs"> 转换为</label>',2),Ee=d('<li class="cursor-pointer hover:bg-slate-600"></li>',2),Ae=d('<ul class="w-full cursor-pointer whitespace-nowrap  rounded-lg bg-slate-800 p-2"><li class="hover:bg-slate-600">🔼上移</li><li class="hover:bg-slate-600"></li><li class="hover:bg-slate-600">🔽下移</li><hr><!#><!/></ul>',11),Be=d('<nav class="cursor-pointer">🧬</nav>',2),De=e=>{const{transform:l}=j(B);return[u(Fe),i(L,{get each(){return e.block.canTransTo},children:n=>(()=>{const t=u(Ee);return t.$$click=()=>{l(e.block,e.block.transTo(n))},$(t,()=>n.label),f(),t})()})]},Y=e=>{const l=()=>{const{move:n,content:t}=j(B),o=b(!1);return(()=>{const s=u(Ae),r=s.firstChild,c=r.nextSibling,a=c.nextSibling,g=a.nextSibling,m=g.nextSibling,[x,_]=h(m.nextSibling);return r.$$click=()=>n(e.block,"up"),c.$$click=()=>o()?t.remove(e.block):o(!0),$(c,()=>o()?"⁉️你确定？":"🚫删除这块"),a.$$click=()=>n(e.block,"down"),$(s,i(De,{get block(){return e.block}}),x,_),f(),s})()};return i(V,{position:"rt",popup:({show:n})=>i(w,{get when(){return n()},get children(){return[i(l,{}),re(()=>e.children)]}}),get children(){return u(Be)}})};v(["click"]);const Me=d('<nav class="cursor-pointer">✨</nav>',2),Ie=d('<ul class="w-full whitespace-nowrap rounded-lg  bg-slate-800 p-2"></ul>',2),Ne=d('<li class="w-full p-1 hover:bg-slate-700"></li>',2),Z=e=>i(V,{position:"rt",popup:({show:l})=>i(w,{get when(){return l()},get children(){const n=u(Ie);return $(n,i(L,{get each(){return e.block.supportAI.map(t=>[t,$e[t]])},children:([t,o])=>(()=>{const s=u(Ne);return s.$$click=()=>e.model(t),$(s,o),f(),s})()})),n}}),get children(){return u(Me)}});v(["click"]);const Pe=d('<section class="flex items-center gap-2  rounded-xl border border-solid border-slate-600 bg-gray-900 p-2"><ul class="flex flex-col items-center gap-1"></ul><div class="flex-1 transition-all"><!#><!/><!#><!/><ul class="flex items-center justify-end gap-2 px-2 text-xl "></ul></div></section>',12),ee=e=>(()=>{const l=u(Pe),n=l.firstChild,t=n.nextSibling,o=t.firstChild,[s,r]=h(o.nextSibling),c=s.nextSibling,[a,g]=h(c.nextSibling),m=a.nextSibling;return n.style.setProperty("line-height","initial"),$(n,()=>e.sideBar),$(t,()=>e.children,s,r),$(t,()=>e.tool,a,g),m.style.setProperty("line-height","initial"),$(m,()=>e.footer),l})(),je=d('<li class="cursor-pointer">📋</li>',2),Le=e=>{const l=b(e.block.content.text),n=b(!1),t=b("textToText",{equals:!1});return M(()=>n(!0),[t]),M(()=>e.block.content.text=l(),[l]),i(ee,{get sideBar(){return[(()=>{const o=u(je);return o.$$click=()=>{H(l()),N.success("复制成功")},f(),o})(),i(Z,{model:t,get block(){return e.block}}),i(Y,{get block(){return e.block}})]},get tool(){return i(w,{get when(){return n()},get children(){return i(Q,{get block(){return e.block},method:t,input:l,onClose:()=>n(!1),onConfirm:o=>l(o)})}})},footer:null,get children(){return i(Se,{placeholder:"这里可以输入文本进行描述，通过 ✨ 按钮使用 AI",text:l})}})};v(["click"]);const qe=d('<li class="cursor-pointer" title="添加模式，左键加权，右键减权">🏷️</li>',2),Ge=d('<li class="cursor-pointer" title="删除模式，点击删除">❌</li>',2),Ke=d('<li class=" cursor-pointer text-sm" title="添加分割符号">➖</li>',2),He=d('<li class="cursor-pointer" title="一键复制">📋</li>',2),Ve=d('<li class="cursor-pointer" title="输入框特写">✒️</li>',2),We=({userCollection:e,inputMode:l})=>{const{t:n}=X(),{emphasizeAddMode:t,deleteMode:o,changeTagMode:s}=P.getApp("data");return[(()=>{const r=u(qe);return r.$$click=()=>s(t,!0),k(c=>K(r,{"rounded-md bg-slate-700":t()},c)),f(),r})(),(()=>{const r=u(Ge);return r.$$click=()=>s(o,!0),k(c=>K(r,{"rounded-md bg-slate-700":o()},c)),f(),r})(),(()=>{const r=u(Ke);return r.$$click=()=>{e(c=>[...c,{...xe}]),N.success(n("toolbar1.hint.addBreakLine"))},f(),r})(),(()=>{const r=u(He);return r.$$click=()=>(H(O(e())),N.success("复制成功")),f(),r})(),(()=>{const r=u(Ve);return r.$$click=()=>l(c=>!c),k(c=>K(r,{"rounded-md bg-slate-700":l()},c)),f(),r})()]};v(["click"]);const ze=e=>{const l=" ,.;|/?？。，；";let n=e.length-1;for(;n>0;n--){const t=e[n];if(l.includes(t))break}return[e.slice(0,n),e.slice(n)]},Ue=d('<ul class="mt-2 w-full max-w-sm rounded-md bg-slate-800 p-2 text-slate-300"></ul>',2),Qe=d('<span class="float-right">↩️</span>',2),Re=d('<li class="pl-2 hover:bg-slate-600"><span class="pr-4"></span><span class="max-w-[50%] text-ellipsis whitespace-nowrap text-xs text-slate-200"></span><!#><!/></li>',8),Oe=({infoList:e,onConfirm:l})=>{const n=b(0);let t;return ce(window,"keydown",o=>{switch(o.key){case"ArrowDown":o.preventDefault(),n(s=>s<e().length-1?s+1:s);break;case"ArrowUp":o.preventDefault(),n(s=>s>0?s-1:s);break;case"Enter":o.preventDefault(),t?.children[n()]?.click();break}}),(()=>{const o=u(Ue),s=t;return typeof s=="function"?D(s,o):t=o,$(o,i(L,{get each(){return e()},children:(r,c)=>{let a;const g=I(()=>n()===c());return oe(()=>{g()&&a.scrollIntoView(!1)}),(()=>{const m=u(Re),x=m.firstChild,_=x.nextSibling,C=_.nextSibling,[p,y]=h(C.nextSibling);m.$$click=F=>{U(()=>{const q=r.originText.endsWith(" ")?r.originText:r.originText+" ";l(q+a.textContent),e([])})};const T=a;return typeof T=="function"?D(T,x):a=x,$(x,()=>r.value),$(_,()=>r.desc),$(m,i(w,{get when(){return g()},get children(){return u(Qe)}}),p,y),k(()=>m.classList.toggle("bg-slate-700",!!g())),f(),m})()}})),o})()};v(["click"]);const Je=d('<aside class="mx-2 flex w-full items-center gap-2 rounded-md  border  border-solid border-slate-600 bg-slate-800 px-2"><div>✒️</div><input class=" w-full flex-1 bg-transparent outline-none" placeholder="在这里输入 Tags; Ctrl+Enter 添加"></aside>',5),Xe=d('<aside class="max-h-[30vh] overflow-auto"></aside>',2),Ye=e=>{const l=b(""),{r18Mode:n}=P.getApp("data"),t=ae(async()=>{const[r,c]=ze(l());return prompt?he.searchTags(c,n()).then(a=>a.map(g=>({...g,originText:r}))):[]},{immediately:!1,initValue:[],deps:[ue(l,200)]}),o=I(()=>!!t().length),s=I(()=>t().map(r=>({originText:r.originText,value:r.en,desc:r.cn})));return i(V,{class:"flex h-full w-full items-center rounded-md py-1 ",disabled:!0,visible:o,popup:({show:r})=>i(w,{get when(){return r()},get children(){const c=u(Xe);return $(c,i(Oe,{onConfirm:a=>l(a),infoList:s})),c}}),get children(){const r=u(Je),c=r.firstChild,a=c.nextSibling;return a.$$keydown=g=>{g.ctrlKey&&g.key==="Enter"&&(g.stopPropagation(),U(()=>{e.userCollection(m=>[...m,...J(l(),[])]),l("")}))},a.addEventListener("blur",()=>setTimeout(()=>o(!1),100)),a.$$input=g=>l(g.target.value),k(()=>a.value=l()),f(),r}})};v(["input","keydown"]);const Ze=e=>[i(Z,{get model(){return e.model},get block(){return e.block}}),i(Y,{get block(){return e.block}})],et=e=>{const l=b(J(e.block.content.text)),n=b(!0),t=b("textToText",{equals:!1}),o=I(()=>O(l()));M(()=>e.block.content.text=o(),[o]);const s=b(!1);M(()=>s(!0),[t]);const{transform:r}=j(B);return i(ee,{get sideBar(){return i(Ze,{model:t,get block(){return e.block}})},get footer(){return i(We,{userCollection:l,inputMode:n})},get tool(){return[i(w,{get when(){return n()},get children(){return i(Ye,{userCollection:l})}}),i(w,{get when(){return s()},get children(){return i(Q,{get block(){return e.block},method:t,input:o,onClose:()=>s(!1),onConfirm:c=>{const a=e.block.transTo(R);a.content.text=c,r(e.block,a)}})}})]},get children(){return i(fe,{usersCollection:l})}})},tt=d("<span></span>",2),nt=d("<span>翻译</span>",2),lt=d('<header class="my-2 flex w-full items-center justify-center gap-4"><!#><!/><span></span><!#><!/><span></span><span>😀</span></header>',12),rt=()=>{const{r18Mode:e}=P.getApp("data"),{visibleId:l}=P.getApp("side-app"),{nav:n}=we(),{t}=X();return(()=>{const o=u(lt),s=o.firstChild,[r,c]=h(s.nextSibling),a=r.nextSibling,g=a.nextSibling,[m,x]=h(g.nextSibling),_=m.nextSibling,C=_.nextSibling;return $(o,i(Ce,{}),r,c),a.$$click=()=>n("/gallery?r18="+(e()?"true":"")),$(a,()=>t("toolbar1.Gallery")),$(o,i(w,{get when(){return!_e()},get children(){return[(()=>{const p=u(tt);return p.$$click=()=>l("uploader"),$(p,()=>t("toolbar1.Share")),k(()=>E(p,"btn "+A.pick(3))),f(),p})(),(()=>{const p=u(nt);return p.$$click=()=>n("https://cn.bing.com/translator/"),k(()=>E(p,"btn "+A.pick(4))),f(),p})()]}}),m,x),_.$$click=()=>{n("./notebook.html")},$(_,()=>t("notebook")),C.$$click=()=>{l("emoji")},k(p=>{const y="btn "+A.pick(2),T="btn font-bold "+A.pick(5),F="btn font-bold "+A.pick(5);return y!==p._v$&&E(a,p._v$=y),T!==p._v$2&&E(_,p._v$2=T),F!==p._v$3&&E(C,p._v$3=F),p},{_v$:void 0,_v$2:void 0,_v$3:void 0}),f(),o})()};v(["click"]);const ot=d('<main class="flex w-full max-w-3xl flex-col  overflow-auto  px-4 text-slate-100"><nav class="sticky top-2 z-50 my-2"><!#><!/><!#><!/></nav><article class="flex h-full w-full flex-1 flex-col gap-4 "><!#><!/><aside class="flex h-full min-h-[20vh] justify-center gap-4 pt-4"><!#><!/><div class="flex h-fit cursor-pointer items-center rounded-lg bg-sky-700 p-2 outline-none">🐰复制全局</div></aside></article><!#><!/></main>',20),st=d('<div class="flex h-fit cursor-pointer items-center rounded-lg bg-purple-800  p-2 "><span>😽添加一个</span><select class="bg-purple-800 px-2 text-xl outline-none "><option value="text">文本</option><option value="tags">魔咒</option></select></div>',10),it=e=>{const l=e??{id:pe(),content:[]},n=de(b(l.content));return{content:n,move(t,o){const s=n(),r=s.indexOf(t),c=o==="up"?s[r-1]:s[r+1];c&&n.switch(t,c),console.log(r)},transform(t,o){n.replace(t,o)}}},Dt=()=>{be();const e=it({id:"1",content:[new ge("((best quality)),(((flat color))),thick outlines,((limited palette)),medium shot,album cover,depth of field,((falling petals)),snowy city street,snow ground and tree with light,gorgeous Norwegian girl,cute natural makeup,long wavy blonde hair,freckles,blue eyes"),new R]});return i(B.Provider,{value:e,get children(){const l=u(ot),n=l.firstChild,t=n.firstChild,[o,s]=h(t.nextSibling),r=o.nextSibling,[c,a]=h(r.nextSibling),g=n.nextSibling,m=g.firstChild,[x,_]=h(m.nextSibling),C=x.nextSibling,p=C.firstChild,[y,T]=h(p.nextSibling),F=y.nextSibling,q=g.nextSibling,[te,ne]=h(q.nextSibling);return $(n,i(ke,{}),o,s),$(n,i(rt,{}),c,a),$(g,i(L,{get each(){return e.content()},children:S=>i(se,{get children(){return[i(z,{get when(){return S.type==="text"},get children(){return i(Le,{block:S})}}),i(z,{get when(){return S.type==="tags"},get children(){return i(et,{block:S})}})]}})}),x,_),$(C,i(ct,{}),y,T),F.$$click=()=>{H(e.content().map(S=>S.content.text).join(`
`)),N.success("复制成功")},$(l,i(ve,{}),te,ne),f(),l}})},ct=()=>{const e=j(B);let l;const n=()=>{e.content(t=>[...t,me(l.value)])};return(()=>{const t=u(st),o=t.firstChild,s=o.nextSibling;o.$$click=n,s.$$input=n;const r=l;return typeof r=="function"?D(r,s):l=s,f(),t})()};v(["click","input"]);export{Dt as Writer};
