var m={},z={get exports(){return m},set exports(e){m=e}};z.exports=x;m.isMobile=x;m.default=x;const T=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,w=/CrOS/,k=/android|ipad|playbook|silk/i;function x(e){e||(e={});let t=e.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;let i=T.test(t)&&!w.test(t)||!!e.tablet&&k.test(t);return!i&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(i=!0),i}const y=e=>([t=>{var i,n;if(t.emphasize<=-1){const[o,r,s,c]=(i=t.text.match(/([^:]+):([^:]*):([\d\.]+)/))!=null?i:[];if(o)return t.weight=c,t.fromTo=[r,s],t.emphasize++,!0;{const[a,l,f]=(n=t.text.match(/([^:]+):([\d\.]+)/))!=null?n:[];if(a)return t.emphasize++,t.weight=f,t.fromTo=["",l],!0}}return!1},t=>{var i;if(t.emphasize>=1){const[n,o,r]=(i=t.text.match(/(.+):([\d\.]+)/))!=null?i:[];if(n)return t.weight=r,t.text=o,t.emphasize--,!0}return!1},t=>t.emphasize<=-1&&t.text.includes("|")?(t.emphasize++,t.alternatingArr=t.text.split("|").map(i=>i.trim()),!0):!1].some(t=>t(e)),e),M=e=>v(`,${e},`,0);let h="({[（",g=")}]）",u=",，";const b=(e,t=!1)=>{let i=0,n=0,o=[];for(let r=0;r<e.length;r++){const s=e[r];h.includes(s)?s==="["?n--:n++:g.includes(s)&&(s==="]"?n++:n--),(r===e.length-1||n===0&&(u.includes(s)||t&&[...g,...h].includes(s)))&&(o.push(e.slice(i,r+1)),i=r+1)}if(n!==0&&[...u].some(r=>o.at(-1).includes(r))){const r=b(o.at(-1).split("").reverse().join(""),!0).map(s=>s.split("").reverse().join("")).reverse();o.pop(),o.push(...r)}return o},v=(e,t=0)=>b(e).filter(i=>!u.includes(i)).flatMap(i=>{if(i.length===0)return[];let n=0,o=i.length-1,r=0,s=0,c=[];for(;n<o;){const l=i[n];if(l===" "||u.includes(l)){n++;continue}else h.includes(l)&&(c.push(n),l==="["?r--:r++,s++,n++);const f=i[o];if(f===" "||u.includes(f))o--;else if(g.includes(f)){if(s===0)break;o--,s--}else break}if(r=s===0?r:r-s,n===o+1)return[];s!==0&&(n=c.at(-s));const a=i.slice(n,o+1);return a!==i&&[...u].some(l=>a.includes(l))?v(a,r+t):[{text:a,emphasize:r+t}]}),$=e=>M(e).map(t=>y(t)),j=e=>e.fromTo&&e.fromTo.length===2&&typeof e.weight=="string"?`[${e.fromTo[0]===""?e.fromTo[1]:e.fromTo.join(":")}:${e.weight}]`:typeof e.weight=="string"?`(${e.text}:${e.weight})`:e.alternatingArr&&e.alternatingArr.length?`[${e.alternatingArr.join("|")}]`:e.text,d=(e,t="()")=>e.map(i=>{const n=Math.abs(i.emphasize),o=i.emphasize>0?t:"[]";return o[0].repeat(n)+j(i)+o[1].repeat(n)}).join(","),F=e=>e.replace(/_/g," ").split(/\r?\n/g),S=e=>e.text===p.text&&e.en===p.en&&e.cn===p.cn,p={text:`
`,en:`
`,cn:`
`,r18:0,count:-1,emphasize:0},A=(e,t=[])=>F(e).map((n,o)=>$(n)).flatMap((n,o)=>{const r=n.map(s=>{const c=t.find(l=>s.text===l.en);if(c)return{...c,...s};const a=t.find(l=>s.text===l.cn);return a?{...a,...s}:{en:s.text,cn:s.text,count:1/0,emphasize:0,r18:0,...s}});return o===0?[...r]:[{...p},...r]}),C=(e,t="()",i=!0)=>{if(i){let n=0,o=[];for(let r=0;r<e.length+1;r++){const s=e[r];(e.length===r||s.text===`
`)&&(o.push(d(e.slice(n,r),t)),n=r+1)}return o.join(`,
`)}else return d(e.filter(n=>n.text!==`
`),t)},E=e=>(e.text===void 0&&(e.text=e.en),e.en===void 0&&(e.en=e.text),e.cn===void 0&&(e.cn=e.text),e);export{E as C,C as T,S as a,p as b,m as i,A as s};
