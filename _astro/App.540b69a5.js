import{j as k,e as s,g as n,f as v,i as c,r as w,t as l,s as U,h as R,S as D,F as j,q,w as J}from"./web.9ee1b91f.js";import{u as K}from"./index.c584f020.js";import{c as O,A as V,C as T}from"./index.79db8632.js";import{M as A,a as Q}from"./MessageHInt.3d0a2276.js";import{N as f}from"./notice.940364ec.js";import{U as W}from"./index.4f2c4b12.js";import{X as Y,d as Z,e as ee,t as X,w as te}from"./index.b92d985b.js";import{G as C}from"./GlobalData.4e554cac.js";import{u as se,F as L}from"./FileSaver.min.1c20ed5c.js";import"./useIndexedDB.84c7bc09.js";import{P as ne}from"./Panel.801c2a10.js";import{U as z}from"./UploadButton.81194c33.js";/* empty css                       */import"./_commonjsHelpers.edff4021.js";import"https://cdn.jsdelivr.net/npm/viewerjs@1.11.2/dist/viewer.esm.min.js";import"./preload-helper.101896b7.js";import"./md5.0fe766d4.js";import"./memoize.49269b7f.js";const ie=l("<span>æŸ¥çœ‹é­”å’’</span>",2),le=l('<section class="flex gap-2 py-2"><!#><!/><span class="font-icon btn whitespace-nowrap bg-green-600 text-sm text-white">âœ’ï¸</span><span class="font-icon btn mr-2 whitespace-nowrap bg-sky-600 text-sm text-white">ğŸ“„</span></section>',8),ue=l('<div class=" pointer-events-none mt-2  w-[70vw] whitespace-pre-wrap rounded-md border border-slate-600 bg-slate-800 p-2 text-left text-sm"></div>',2),re=i=>{const{ChangeMagic:a}=C.getApp("notebook");return s(V,{send:(t,g)=>{t("INPUT_MAGIC",i.data().tags),g.setData("text",i.data().tags),A.success("æ‚¨å¯ä»¥æ‹–æ‹½é­”å’’åˆ°å…¶ä»–é¡µé¢")},get children(){const t=n(le),g=t.firstChild,[u,m]=v(g.nextSibling),d=u.nextSibling,$=d.nextSibling;return c(t,s(Y,{class:"btn flex-1 whitespace-nowrap text-sm text-white",animateProps:{anime:"scale"},popup:()=>(()=>{const r=n(ue);return c(r,()=>i.data().tags),r})(),get children(){return n(ie)}}),u,m),d.$$click=r=>{r.stopPropagation();const _=prompt("è¯·ä¿®æ”¹é­”å’’",i.data().tags);_&&a({...i.data(),tags:_}).then(()=>i.data.refetch()).then(()=>{f.success("ä¿®æ”¹é­”å’’æˆåŠŸ")})},$.$$click=()=>{O(i.data().tags),f.success("å¤åˆ¶æˆåŠŸ")},w(),t}})};k(["click"]);const ce=l('<img loading="lazy" class="h-full w-full  object-cover " alt="">',1),ae=i=>{const a=W(i.fetch),{replaceImages:t,getViewer:g}=se();return s(D,{get when(){return a.isReady()},fallback:"åŠ è½½ä¸­",get children(){const u=n(ce);return u.$$click=()=>{t([{src:a(),origin:a(),alt:a()}]),g().view(0)},U(u,"draggable",!1),u.style.setProperty("min-height","100%"),u.style.setProperty("min-width","100%"),R(()=>U(u,"src",a())),w(),u}})};k(["click"]);const oe=l(`<div class="h-32 w-32 flex-none cursor-pointer overflow-hidden rounded-lg" title="ç‚¹å‡»æŸ¥çœ‹
æ‹–åŠ¨åˆ°åˆ é™¤æŒ‰é’®åˆ é™¤"></div>`,2),de=i=>{const{getImage:a}=C.getApp("notebook");return s(V,{send:t=>t("MAGIC_IMAGE",{origin:i.data,position:i.id}),get children(){const t=n(oe);return c(t,s(ae,{fetch:()=>a(i.id)})),t}})},pe=l('<div class="grid grid-cols-1 gap-4 overflow-y-scroll py-2 pb-24 md:grid-cols-2"></div>',2),ge=l('<div class="w-full text-center"><div class="text-center text-sm text-amber-500">ä½ å¯ä»¥æ‹–æ‹½ä»»æ„çš„å­—ç¬¦ä¸²åˆ°è¿™ä¸ªç½‘ç«™ä½œä¸º TAGï¼</div><span>æ•°æ®ä¸ºç©º, ä½ å¯ä»¥</span><ol class=" px-4 text-left"><li>1. ç›´æ¥æ‹–æ‹½é­”å’’æ–‡æœ¬åˆ°è¿™é‡Œ</li><li>2. åœ¨é­”å¯¼ç»ªè®ºæ‹–æ‹½ä¸€é”®å¤åˆ¶æŒ‰é’®åˆ°è¿™é‡Œ</li></ol></div>',12),$e=l('<div class="font-icon btn bg-rose-700 text-gray-200">x</div>',2),me=l('<div class="flex justify-between"><span>è¿™ä¸ªåŒºå—è²Œä¼¼å‡ºç°äº† BUGï¼Œå¦‚æœé‡æ–°åŠ è½½ä¸è¡Œï¼Œå°±åˆ é™¤å§</span><!#><!/><div class="btn bg-sky-700">é‡æ–°åŠ è½½</div></div>',8),xe=l('<header class="flex cursor-pointer justify-between"><div class="flex cursor-pointer items-center gap-2" title="ç‚¹æˆ‘ä¿®æ”¹æ ‡é¢˜"><span></span><span class="font-icon">ğŸ“</span></div><div class="flex "></div></header>',10),fe=l('<nav class="my-1 w-full bg-gray-700" style="height:1px"></nav>',2),he=l('<span class="cursor-pointer  text-gray-500"><!#><!/><span class="font-icon float-right whitespace-nowrap ">ğŸ“</span></span>',6),_e=l('<div class="my-2 flex flex-nowrap gap-4 overflow-y-auto overflow-x-visible"></div>',2),Fe=l('<div class="flex justify-between py-1 text-xs text-gray-600"><nav></nav><nav></nav></div>',6),be=l('<div class=" rounded-md bg-slate-800 p-4 shadow-lg shadow-gray-900"><!#><!/><!#><!/></div>',6),ve=l("<div> åŠ è½½ä¸­</div>",2),we=l('<span class="text-gray-500">æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œæ·»åŠ  Demo</span>',2),Be=()=>{const{hidImage:i,IndexList:a,store:t,DeleteMagic:g,ChangeMagic:u,AddDemoImage:m,DeleteImage:d}=C.getApp("notebook");return(()=>{const $=n(pe);return c($,s(j,{get each(){return a()},get fallback(){return n(ge)},children:(r,_)=>{const e=W(()=>t.getItem(r).then(o=>o)),y=s(T,{detect:{MAGIC_IMAGE(){A.warn("ä»é­”å’’ä¸­åˆ é™¤è¿™ä¸ªå›¾ç‰‡")}},receive:{MAGIC_IMAGE(o){d(o.origin,o.position).then(()=>{e.refetch(),f.success("åˆ é™¤æˆåŠŸ")})}},get children(){const o=n($e);return o.$$click=()=>{confirm(`æ˜¯å¦åˆ é™¤${e()?.title}
${e()?.tags}`)&&g(e()?.id??a()[_()]).then(()=>f.success("åˆ é™¤æˆåŠŸ"))},w(),o}});return s(T,{detect:{PURE_TAGS(){A.success("æ¾æ‰‹ï¼Œä¿®æ”¹é­”å’’æ–‡æœ¬")},extra(o){o.types.includes("Files")&&A.success("æ·»åŠ å›¾ç‰‡åˆ°è¿™ä¸ªé­”å’’")}},receive:{PURE_TAGS(o){u({...e(),tags:o}).then(()=>e.refetch()).then(()=>{f.success("ä¿®æ”¹é­”å’’æˆåŠŸ")})},extra(o,B){Promise.all([...B.files].filter(h=>h.type.startsWith("image/")).map(h=>m(h,e()))).then(h=>{h.length&&e.refetch()})}},get children(){const o=n(be),B=o.firstChild,[h,I]=v(B.nextSibling),M=h.nextSibling,[P,G]=v(M.nextSibling);return c(o,s(D,{get when(){return e()===null},get children(){const p=n(me),x=p.firstChild,b=x.nextSibling,[E,F]=v(b.nextSibling),S=E.nextSibling;return c(p,y,E,F),S.$$click=()=>{f.success("é‡æ–°åŠ è½½å¼€å§‹"),e.refetch()},w(),p}}),h,I),c(o,s(D,{get when(){return e.isReady()},get fallback(){return n(ve)},get children(){return[(()=>{const p=n(xe),x=p.firstChild,b=x.firstChild,E=x.nextSibling;return x.$$click=()=>{const F=prompt("è¯·è¾“å…¥è¿™ä¸ªé­”å’’çš„åç§°",e().title);F&&u({...e(),title:F}).then(S=>e.refetch())},c(b,()=>e().title),c(E,y),w(),p})(),n(fe),(()=>{const p=n(he),x=p.firstChild,[b,E]=v(x.nextSibling),F=b.nextSibling;return c(p,()=>e().description||"æ²¡æœ‰æè¿°ä¿¡æ¯å“¦",b,E),F.$$click=S=>{S.stopPropagation();const N=prompt("è¯·ä¿®æ”¹æè¿°",e().description);N&&u({...e(),description:N}).then(()=>e.refetch())},w(),p})(),s(re,{data:e}),s(D,{get when(){return!i()},get children(){const p=n(_e);return c(p,s(j,{get each(){return e().demos},get fallback(){return n(we)},children:x=>s(de,{get data(){return e()},id:x})})),p}}),(()=>{const p=n(Fe),x=p.firstChild,b=x.nextSibling;return c(x,()=>new Date(e().create_time).toLocaleDateString()),c(b,()=>new Date(e().last_update).toLocaleDateString()),p})()]}}),P,G),o}})}})),$})()};k(["click"]);const Ee=l('<main class="m-auto mx-auto my-4 w-full max-w-sm rounded-lg border border-slate-600 p-4"><header class="my-4 text-lg text-white">æ•°æ®å­˜å‚¨ç³»ç»Ÿ</header><!#><!/></main>',6),Ce=l('<div class="btn text-sm text-white"></div>',2),Ae=l('<div class="my-2 rounded bg-green-800 p-2 text-sm text-white">æ‚¨å¯ä»¥åœ¨è¿™é‡Œå¤‡ä»½æ‚¨çš„é­”å’’ç¬”è®°ã€‚æ–‡ä»¶å¤‡ä»½å°†ä¿ç•™æ‚¨çš„é­”å’’æ–‡æœ¬ï¼Œè€Œå›¾ç‰‡æ•°æ®ç”±äºå¤ªå¤§ï¼Œæ‰€ä»¥éœ€è¦åˆ†ç‰‡å•ç‹¬ä¸‹è½½ã€‚</div>',2),ye=l('<section class="flex flex-col gap-4"><div class="btn"><span class="font-icon">ğŸ“·</span>ä¸‹è½½é­”å’’æ–‡ä»¶</div><div class="btn"><span class="font-icon">ğŸ“·</span>ä¸‹è½½æ‰€æœ‰å›¾ç‰‡</div></section>',10),ke=l('<div class="my-2 rounded bg-blue-800 p-2 text-sm text-white">å¯¼å…¥æ‚¨å¯¼å‡ºçš„æ–‡ä»¶, æ‰€æœ‰å¯¼å…¥æ–‡ä»¶éƒ½å°†ä¼šæ·»åŠ åˆ°ç°æœ‰æ•°æ®ä¸­æ¥</div>',2),H=l('<span class="font-icon">ğŸ“·</span>',2),Se=l('<section class="flex flex-col gap-4"><!#><!/><!#><!/></section>',6),De=()=>s(ne,{id:"backup",get children(){const i=n(Ee),a=i.firstChild,t=a.nextSibling,[g,u]=v(t.nextSibling);return c(i,s(Z,{activeId:"å¯¼å‡º",get children(){return[s(ee,{children:m=>{const{changeSelected:d,isSelected:$}=q(te);return(()=>{const r=n(Ce);return r.$$click=()=>{d(m,!0)},c(r,m),R(()=>r.classList.toggle("bg-red-600",!!$(m))),w(),r})()}}),s(Ie,{}),s(Me,{})]}}),g,u),i}}),Ie=()=>{const{ExportText:i,ExportImage:a}=C.getApp("notebook");return s(X,{id:"å¯¼å‡º",get children(){return[n(Ae),(()=>{const t=n(ye),g=t.firstChild,u=g.nextSibling;return g.$$click=async()=>{const m=await i();L.saveAs(m,`é­”å¯¼ç»ªè®ºå¯¼å‡º-${Date.now()}.json`)},u.$$click=async()=>{if(confirm("å°†ä¼šè¿›è¡Œæ‰“åŒ…åˆ†åŒ…ä¸‹è½½å›¾ç‰‡")){const d=Date.now();await a(async($,r)=>{L.saveAs($,`é­”å¯¼ç»ªè®ºå›¾ç‰‡å¯¼å‡º-${d}-${r}.zip`)})}},w(),t})()]}})},Me=()=>{const{ImportText:i,ImportImage:a}=C.getApp("notebook");return s(X,{id:"å¯¼å…¥",get children(){return[n(ke),(()=>{const t=n(Se),g=t.firstChild,[u,m]=v(g.nextSibling),d=u.nextSibling,[$,r]=v(d.nextSibling);return c(t,s(z,{accept:"application/json",onUpload:_=>{i(_[0]).then(()=>{f.success("å¯¼å…¥æˆåŠŸ, åˆ·æ–°é¡µé¢åæ˜¾ç¤º")})},get children(){return[n(H),"å¯¼å…¥é­”å’’æ–‡ä»¶"]}}),u,m),c(t,s(z,{multiple:!0,onUpload:async _=>{f.success("å¼€å§‹è¿›è¡Œå¯¼å…¥ï¼Œè¯·ç¨ç­‰");for(const e of _)await a(e),f.success("æˆåŠŸå¯¼å…¥åˆ†ç‰‡");f.success("å…¨éƒ¨å¯¼å…¥å®Œæˆï¼Œè¯·åˆ·æ–°é¡µé¢")},get children(){return[n(H),"å¯¼å…¥æ‰€æœ‰å›¾ç‰‡"]}}),$,r),t})()]}})};k(["click"]);const Pe=l('<main class="font-global relative m-auto flex h-screen w-full max-w-6xl flex-col  items-center   overflow-y-auto overflow-x-visible text-gray-400"><header class="sticky top-2 z-40  w-full max-w-6xl "><section class=" my-4  mx-2 flex items-center divide-x-2 divide-gray-700 rounded-md bg-slate-800 p-2 shadow-lg shadow-gray-900"><header class=" pl-2 pr-4 text-xl">é­”å’’è®°å¿†å™¨</header><div class="flex flex-1 items-center justify-end "><div class="font-icon h-8 w-8 cursor-pointer rounded-md p-1 text-center transition-colors hover:bg-slate-700">âœ’ï¸</div><div class="font-icon h-8 w-8 cursor-pointer rounded-md p-1 text-center transition-colors hover:bg-slate-700">ğŸ”ƒ</div><div class="font-icon h-8 w-8 cursor-pointer rounded-md p-1 text-center transition-colors hover:bg-slate-700"></div><div class="h-fit rounded-md p-1 text-xs hover:bg-slate-700">ğŸ“ <!#><!/></div></div></section></header><section class="flex w-full flex-col  overflow-x-visible px-2"></section><!#><!/></main>',24),Ge=J(),et=()=>{const{visibleId:i,registerPanel:a}=C.getApp("side-app");a("backup",De);const{t}=K(),{hidImage:g,addMagic:u,IndexList:m}=C.getApp("notebook");return s(Ge.Provider,{value:{hidImage:g},get children(){return s(T,{detect:{PURE_TAGS(){A.success(t("Notebook.hint.PURE_TAGS"))},extra(d){[...d.types.values()].some($=>$.startsWith("text"))&&A.success(t("Notebook.hint.text"))}},multi:!1,receive:{PURE_TAGS(d){return u(d),f.success("åˆ›å»ºé­”å’’æˆåŠŸ"),!0},extra(d,$){const r=$.getData("text");r&&confirm(`è¿™æ˜¯ä¸€ä¸ªé­”å’’å—ï¼Ÿ
 ${r}`)&&(u(r),f.success("åˆ›å»ºé­”å’’æˆåŠŸ"))}},get children(){const d=n(Pe),$=d.firstChild,r=$.firstChild,_=r.firstChild,e=_.nextSibling,y=e.firstChild,o=y.nextSibling,B=o.nextSibling,h=B.nextSibling,I=h.firstChild,M=I.nextSibling,[P,G]=v(M.nextSibling),p=$.nextSibling,x=p.nextSibling,[b,E]=v(x.nextSibling);return y.$$click=()=>{const F=prompt("è¯·è¾“å…¥éœ€è¦æ·»åŠ çš„é­”å’’");F&&(u(F),f.success("åˆ›å»ºé­”å’’æˆåŠŸ"))},o.$$click=()=>i("backup"),B.$$click=()=>g(F=>!F),c(B,()=>g()?"ğŸªŸ":"ğŸ“·"),c(h,()=>m().length,P,G),c(p,s(Be,{})),c(d,s(Q,{}),b,E),R(()=>U(h,"title",`ä½ æœ‰ ${m().length} ä»½é­”å’’`)),w(),d}})}})};k(["click"]);export{et as Notebook};
