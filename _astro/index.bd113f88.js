import{j as z,g as m,f as p,k as w,i as s,e as x,r as N,t as f,F as A,h as G,s as K}from"./web.9ee1b91f.js";import{Q as T}from"./index.4f2c4b12.js";import{A as c}from"./cloud.6055f26b.js";import"./index.b92d985b.js";import{C as W}from"./CategoriesInput.2aa6ab6d.js";import"https://cdn.jsdelivr.net/npm/leancloud-storage@4.14.0/dist/av-min.js";/* empty css                       */import"./_commonjsHelpers.edff4021.js";const X=$=>{const o=new c.Object("gallery_category");return o.set("categories",$),o},Y=f('<section><header><button>👈</button><span><!#><!/>/<!#><!/></span><button>👉</button><span>按住图片可放大</span><button class="btn"> 更新</button></header><main class="grid grid-cols-6"></main></section>',20),Z=f('<div><img class="active:scale-[4]" height="100" width="100"><nav class="my-2 flex flex-wrap gap-2"><!#><!/><!#><!/></nav></div>',9),ee=f('<button class="btn " title="双击删除"></button>',2),oe=()=>{if(!c.User.current()){const n=prompt("用户名"),r=prompt("密码");c.User.logIn(n,r)}const{currentData:$,next:o,prev:E,currentPage:F,maxPage:j,refetch:d,goto:D}=T(async(n,r)=>{const a=new c.Query("gallery");return a.addDescending("create_time"),a.limit(10).skip(n*10).findAndCount().then(([t,_])=>(r(Math.ceil(_/10)),t))},{});return(()=>{const n=m(Y),r=n.firstChild,a=r.firstChild,t=a.nextSibling,_=t.firstChild,[h,I]=p(_.nextSibling),O=h.nextSibling,P=O.nextSibling,[B,M]=p(P.nextSibling),S=t.nextSibling,Q=S.nextSibling,U=Q.nextSibling,q=r.nextSibling;return w(a,"click",E,!0),t.$$click=()=>{const e=prompt("请输入页码"),l=parseInt(e??"");!isNaN(l)&&D(l-1)},s(t,F,h,I),s(t,j,B,M),w(S,"click",o,!0),U.$$click=()=>d(),s(q,x(A,{get each(){return $()},children:e=>{const l=e.toJSON();return(()=>{const C=m(Z),k=C.firstChild,b=k.nextSibling,H=b.firstChild,[v,J]=p(H.nextSibling),L=v.nextSibling,[R,V]=p(L.nextSibling);return s(b,x(A,{get each(){return l.categories},children:(i,g)=>(()=>{const u=m(ee);return u.$$dblclick=async()=>{const y=[...e.get("categories")];y.splice(g(),1),e.set("categories",y),await e.save(),d()},s(u,i),N(),u})()}),v,J),s(b,x(W,{onselect:async i=>{if(i){const g=e.get("categories");if(g.includes(i))return;e.set("categories",[...g,i]);try{await c.Object.saveAll([e,X(i)])}catch{}d()}}}),R,V),G(()=>K(k,"src",l.image)),C})()}})),N(),n})()};z(["click","dblclick"]);export{oe as CategoriesPicker};
